$.fn.extend({
	dropdown: function(a) {
		var b = $.extend({
			evt: "click"
		}, a);
		var c = this;
		if (b.evt == "hover") {
			c.bind("mouseenter", function() {
				c.addClass("open");
			});
			c.bind("mouseleave", function() {
				c.removeClass("open");
			});
		} else {
			c.bind(b.evt, function(d) {
				d.preventDefault();
				c.toggleClass("open");
			});
		}
		$(document).bind("click", function(d) {});
	},
	affix: function(e) {
		var a = $.extend({
			top: 0,
			bottom: null,
			oHeight: null
		}, e),
			g = this,
			i = g.get(0).offsetParent || document.body,
			i = i.tagName.toLowerCase() == "html" ? document.body : i,
			d = $(i),
			j = d.length && d.height(),
			b = a.oHeight || g.height(),
			k = g.offset().top,
			h = document.body.scrollTop || document.documentElement.scrollTop;
		if (h >= k - a.top) {
			if (a.bottom && h + b + a.bottom > j) {
				j - a.bottom - k - b > b && g.removeClass("affix").addClass("affix-bottom").css({
					bottom: a.bottom
				});
				d.length && d.css("position", "relative");
			} else {
				g.hasClass("affix") || g.addClass("affix");
			}
		}
		if (typeof document.body.style.maxHeight == "undefined") {
			var c = tuan800ued.getModule("ie6Fixed").fixed,
				f = $(window).height();
			c && c(g, (f - b) / 2);
		} else {
			$(window).bind("scroll", function() {
				var l = document.body.scrollTop || document.documentElement.scrollTop;
				if (d.height() != j) {
					j = d.height();
				}
				if (l >= k - a.top) {
					if (a.bottom && l + b + a.bottom > j) {
						if (g.hasClass("affix")) {
							g.removeClass("affix").addClass("affix-bottom").css({
								bottom: a.bottom
							});
							d.length && d.css("position", "relative");
						}
					} else {
						if (!g.hasClass("affix")) {
							g.addClass("affix").removeClass("affix-bottom").css("bottom", "");
							d.css("position", "");
						}
					}
				} else {
					g.hasClass("affix") && g.removeClass("affix");
				}
			});
		}
		return this;
	},
	tooltip: function(e) {
		var a = $.extend({
			autoLoc: true
		}, e);
		var g = this,
			f = $('<div class="tooltip"><div class="tooltip-content">' + a.msg + '<i class="close"></i></div><div class="tooltip-arrow"></div></div>').insertAfter(g),
			h = g.position(),
			i = f.find(".tooltip-arrow"),
			b = g.width(),
			c = g.height(),
			d = f.width(),
			j = f.height();
		a.autoLoc && f.css({
			top: h.top - j - i.height(),
			left: h.left - (d - b) / 2
		});
		f.find(".close").bind("click", function() {
			f.hide();
		});
	}
});
(function(a) {
	tuan800ued.addModule("dropbind", {
		OnLoad: function() {
			a(".zhe_intro,.sign_panel,.search .sort,.web-focus").each(function() {
				a(this).dropdown({
					evt: "hover"
				});
			});
		}
	});
	tuan800ued.addModule("search", {
		OnLoad: function() {
			var g = a(".header .search"),
				j = g.find("form"),
				c = g.find(".sort"),
				h = c.find("a"),
				f = h.filter(".dj"),
				d = h.filter(".qw"),
				e = c.siblings(".txt"),
				i = e.siblings("label"),
				b = c.find(".dropdown-menu");
			d.hasClass("active") && i.show();
			d.bind("mouseenter", function() {
				f.removeClass("active");
			});
			d.bind("mouseleave", function() {
				f.addClass("active");
			});
			c.delegate("a", "click", function(n) {
				n.preventDefault();
				var m = a(this);
				if (m.hasClass("dj")) {
					j.attr({
						action: "/",
						target: "_self"
					});
					e.attr("name", "keyword");
					i.hide();
				} else {
					j.attr({
						action: "http://s.etao.com/search",
						target: "_blank"
					});
					e.attr("name", "q");
					e.val() || i.show();
				}
				if (m.closest(".dropdown-menu").length) {
					var l = c.find("a"),
						k = l.not(m),
						p = m.attr("class").split(" ")[0],
						o = m.text();
					m.attr({
						"class": k.attr("class").split(" ")[0]
					});
					m.html(k.text());
					k.attr("class", p);
					k.html(o + '<i class="icon-arrow arrow-down"></i>');
				}
				c.removeClass("open");
			});
			e.focus(function() {
				i.hide();
			});
			e.blur(function() {
				var k = h.filter(".qw");
				k.hasClass("active") && !e.val() && i.show();
			});
			i.click(function() {
				e.focus();
			});
			if (!("placeholder" in document.createElement("input"))) {
				a("input,textarea").each(function(k, o) {
					var l = a(this),
						m = l.attr("placeholder");
					if (m) {
						l.val(m);
						l.focus(function() {
							var n = l.val();
							n == m && l.val("");
						});
						l.blur(function() {
							var n = l.val();
							n == "" && l.val(m);
						});
					}
				});
			}
		}
	});
	tuanpub.addModule("sideNav", {
		Init: function() {
			a.getCss("/static/img/css/patch33067.css")
		},
		OnLoad: function() {
			var d = document.location.href;
			base = "/", data = {
				tag: {
					"服装": "?m=fuzhuang",
					"鞋包": "?m=xiebao",
					"配饰": "?m=peishi",
					"户外": "?m=huwai",
					"珠宝": "?m=zhubao",
					"数码": "?m=shuma",
					"家电": "?m=jiadian",
					"护肤": "?m=hufu",
					"母婴": "?m=muying",
					"新品": "?m=xinpin",
					"预告": "?m=yugao",
					"往期": "?m=before",
					"9块9": "?m=jiu",
					"20封顶": "?m=ershi",
					"聚精品": "?m=ju",
					"品牌团": "?m=tuan"
				},
				channel: {
					"值得买": "?m=zdm",
					"值得逛": "?m=guang"
				},
				appcode: "/static/img/v1/ju/core/img/appcode.png"
			}, txt = new a.Buffers();
			var e = ["contact", "service_terms"];
			for (var c = 0; c < e.length; c++) {
				if (d.indexOf(e[c]) != -1) {
					return false
				}
			}
			txt.push('<div class="logo"><a href="' + base + '"><img alt="" src="/static/img/v1/ju/core/img/side_logo.png"></a></div><div class="content"><div class="hd"><h3><a href="' + base + '">全场优惠</a></h3></div>');
			b(data.tag, true);
			txt.push('<div class="hd"><h3>精选推荐</h3></div>');
			b(data.channel);
			txt.push('</div><div class="bd2 move_padding"><div class="clearfix add_link phone"><a href="http://m.mswang.net/" target="_blank" class="pic" title="访问手机版"><i class="phone_w"></i></a>');
			txt.push('<div class="qr_code"><div class="border"><i></i></div><div class="left"><a href="http://m.mswang.net/" target="_blank" class="pic" title="访问手机版"></a></div></div></div>');
			txt.push('<div class="add_link"><a href="http://wpa.qq.com/msgrd?v=3&uin=2529681043&site=&menu=yes" target="_blank" title="点击这里联系网站客服"><i class="contact_w"></i></div></div>');
			txt.push('</div><div class="bottom"><a id="goTop" href="javascript:void(0)"><i class="icon-top"></i>TOP</a></div>');
			a('<div class="side_nav"></div>').html(txt.toString()).appendTo(a("body")).affix({
				top: 70,
				maxTop: a(".about").length ? a(".about").offset().top - 20 : null,
				oHeight: 587
			}).delegate("#goTop", "click", function() {
				var f = document.body.scrollTop ? document.body : document.documentElement;
				a(f).animate({
					scrollTop: 0
				}, 300)
			}).find(".add_link").hover(function() {
				a(this).addClass("add_link_hover").find(".qr_code").show()
			}, function() {
				a(this).removeClass("add_link_hover").find(".qr_code").hide()
			});

			function b(h, f) {
				var g = f ? base : "";
				txt.push('<div class="bd"><ul>');
				a.each(h, function(i, j) {
					if (d.indexOf(j) != -1) {
						txt.push('<li><a class="on" href="' + g + j + '">' + i + "</a></li>")
					} else {
						txt.push('<li><a href="' + g + j + '">' + i + "</a></li>")
					}
				});
				txt.push("</ul></div>")
			}
			a(".side_nav .content ul").eq(0).find("li").last().addClass("jzdcls").append("<b></b>")
		}
	});
})(jQuery);
(function(a) {
	tuanpub.loginQueue = new a.Buffers("queue");
	tuanpub.logoutQueue = new a.Buffers("queue");
	tuanpub.queue = a.extend(tuanpub.queue, {
		login: function() {
			tuanpub.opts.login = true;
			a.each(tuanpub.loginQueue.toArray(), function(c, b) {
				if (a.type(b) == "function") {
					try {
						b()
					} catch (d) {}
				}
			})
		},
		logout: function() {
			tuanpub.opts.login = false;
			a.each(tuanpub.logoutQueue.toArray(), function(c, b) {
				if (a.type(b) == "function") {
					try {
						b()
					} catch (d) {}
				}
			})
		}
	})
})(jQuery);